document.addEventListener("DOMContentLoaded", () => {
  const corPrimaria = document.getElementById("corPrimariaCliente");
  const fundoInicio = document.getElementById("fundoInicioCliente");
  const fundoFim = document.getElementById("fundoFimCliente");
  const btnSalvar = document.getElementById("btnSalvarVisualCliente");

  // proteÃ§Ã£o bÃ¡sica de DOM
  if (!corPrimaria || !fundoInicio || !fundoFim || !btnSalvar) return;

  const cfg = ConfigClinica?.obter?.();
  if (!cfg) return;

  // ðŸ”’ NÃƒO bloqueia, apenas nÃ£o carrega se ainda nÃ£o tiver clÃ­nica
  if (cfg.clinica_id) {
    corPrimaria.value = cfg.visual_cliente?.cor_primaria || "#6C4AB6";
    fundoInicio.value = cfg.visual_cliente?.fundo_inicio || "#F3EFFF";
    fundoFim.value = cfg.visual_cliente?.fundo_fim || "#E6DBFF";
  }

  btnSalvar.onclick = () => {
    const c = ConfigClinica?.obter?.();
    if (!c || !c.clinica_id) {
      // ðŸ‘‡ comportamento sÃªnior: ignora silenciosamente
      console.warn("Visual cliente ignorado: clÃ­nica ainda nÃ£o definida");
      return;
    }

    c.visual_cliente = {
      cor_primaria: corPrimaria.value,
      fundo_inicio: fundoInicio.value,
      fundo_fim: fundoFim.value
    };

    ConfigClinica.salvar(c);
    alert("Visual do cliente salvo com sucesso!");
  };
});
